<html>
<head>
    <head>
        <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
         <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
    </head>
<body style="margin:3em;">
<h1 style="font-style:bold;font-size:2em;font-style:serif;">COSMIC-LYMPHA<br>För uträkning av vidarehandläggning baserat på LYMPHA-skript och lab-svar från COSMIC</h1>
<hr style="margin:0em 0em 1.5em 0em;border-color:#888;border-width:1px;background-color:#eeeeee;" >
Markera läkemdlentyperna av prov till vänster i lab-svars-modulen i COSMIC. Tryck Ctrl + C. Sätt markören i rutan "Provtyper" och trycka på Ctrl + V. Klicka sedan någonstans r tabellen med provsvar. Tryck sedan Ctrl + A och därefter Ctrl + C. Sätt markören i rutan "Provsvar" och trycka på Ctrl + V. Tryck sedan på knappen "Kalkylera".
<hr style="margin:0em 0em 1.5em 0em;border-color:#888;border-width:1px;background-color:#eeeeee;" >
<br>
<br>
Provtyper
<br>
<textarea cols="100" rows="10" style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" type="text" id="heads"> </textarea>
<br>
<br>
Provsvar
<br>
<textarea cols="100" rows="10" style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" type="text" id="data"> </textarea>
<br>

	<button pys-onClick="calculate">
		Kalkylera
	</button>

<div id="assessment"></div>
	
<hr style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" >

    <py-env>
    #- re
    </py-env>
    <py-script>
    from js import console
    lab_tests = dict()
    def calculate(*args, **kwargs):     
        heads = Element('heads').element.value
        headrows = heads.split("\n")
        data = Element('data').element.value
        datarows = heads.split("\n")
        rowspecific = dict()
        rowsdata = dict()
			

#For data specifications:
        for rowidx, row in enumerate(headrows):
            title = str()
            while row[0] == " " :
                row = row[1:]
                if row[0] != " " :
                    break
            
            rowlist = row.split("\t")
            for idx, subitem in enumerate(rowlist):
                if idx == 0 :
                    title = subitem
                    rowspecific[rowidx] = title                

        heads = Element('heads').element.value
        rows = heads.split("\n")
        table = dict()

#For table data:
        for rowidx, row in datarows:
            rowvalue = dict()
            while row[0] == " " :
                row = row[1:]
                if row[0] != " " :
                    break
            rowlist = row.split("\t")		
            for subitem in enumerate(rowlist):
                if subitem == "" :
                    break
                else:
                    rowspecific[rowidx] = subitem            
            rowsdata[rowidx] = rowvalue

#Assessment:
			  for i in range(len(rowspecific)):
                        
            specs = rowspecific[i]

			
            number = rowsdata[i]		
            Element('assessment').element.innerText = (specs + number)
    </py-script>
</body>
</html>
