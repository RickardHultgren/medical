<html>
    <head>
        <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
        <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
    </head>
<body style="margin:3em;">
<h1>Medical Record</h1>
    Select ICD:
    <select id="ICD" name="ICD" style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;">
        <option value="NFB29">NFB29 Primär total höftledsplastik utan cement</option>
        <option value="NFB39">NFB39 Primär total höftledsplastik med hybridteknik</option>
        <option value="NFB49">NFB49 Primär total höftledsplastik med cement</option>
        <option value="NGB49">NGB49 Primär totalprotes i knäled med cement</option>
        <option value="ABC99">ABC99 Dekompressiva operationer på ryggmärgen och nervrötter</option>
    </select>
    <button id="select-button" type="submit" pys-onClick="select_function" style="border-color:#000;border-width:1px;"/>OK</button>

<hr style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" >
<hr style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" >
<hr style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" >


    <div>Inskrivningsdatum</div>
    <input style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" type="text" id="indate-input" />

    <div>Utdatum</div>
    <input style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" type="text" id="outdate-input" style="border-color:#000;border-width:1px;"/>

    <div>Operationsdatum</div>
    <input style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" type="text" id="opdate-input" style="border-color:#000;border-width:1px;"/>

    <div>Operationstyp</div>
    <input style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" type="text" id="type-input" style="border-color:#000;border-width:1px;"/>

    <div>Sida</div>
    <select style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" id="side-input">
        <option value="höger sida">höger sida</option>
        <option value="vänster sida">vänster sida</option>
        <option value="båda sidor">båda sidor</option>
    </select>

    <div>Avdelning</div>
    <input style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" type="text" id="ward-input" style="border-color:#000;border-width:1px;"/>

    <button id="submit-button" type="submit" pys-onClick="submit_function" style="border-color:#000;border-width:1px;">OK</button>
    <hr style="border:1em;">
    <div id="output"></div>
<hr style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" >
<hr style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" >
<hr style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" >
<b>Läkemdel</b><br>
<div id="pharma-list">
</div>
<hr style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" >
<hr style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" >
<hr style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" >
<b>Plan</b>
<div id="plan"></div>
<hr style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" >
<hr style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" >
<hr style="margin:0em 0em 1.5em 0em;border-color:#000;border-width:1px;background-color:#eeeeee;" >
<b>Epikris</b>
<div id="epikris"></div>
    <py-env>
    </py-env>
    <py-script>
    from js import console
    from datetime import date
    from datetime import timedelta

    ICd = str("")
    indate = str("")
    outdate = str("")
    opdate = str("")
    type = str("")
    side = str("")
    ward = str("")
    pharma = str("")

    today = date.today()
    yesterday = today - timedelta(days = 1)

    def select_function(*args, **kwargs):
        console.log(f'args: {args}')
        console.log(f'kwargs: {kwargs}')
        global ICD
        global indate 
        global outdate 
        global opdate 
        global type 
        global side 
        global ward     

        side = Element('side-input').element.value

        ICD = Element('ICD').element.value        
        if ICD == "NFB29" :
            pharma_pat = ("Medicin från avdelningen:\nEtoricoxib 120mg 1 tablett 1 gånger dagligen i 5 dagar. Mot smärta.\n\nMedicin från apoteket:\nOmeprazol 20mg 1 tablett 1 gång dagligen i 2 veckor. Magskyddande.\nCilaxoral 7,5mg/ml 10 droppar i 1 vecka. Förebygger förstoppning.\nEliquis 2,5mg 1 tablett 2 gånger dagligen i 30 dagar. Förebygger blodpropp.\nOxynorm 5mg 1 vid behov, max 4 dagligen, i 2 veckor. Korttidsverkande mot smärta.\nParacetamol 500mg 2 tabletter 3 gånger dagligen i 4 veckor. Smärtlindrande\nSolvezink 45mg 1 tablett 2 gånger dagligen i 3 veckor. För sårläkning.")
            #pharma = ("Cilaxoral 7,5mg/ml 10 droppar i 1 vecka.\nEliquis 2,5mg 1x2 i 30 dagar.\nOmeprazol 20mg 1x1 i 2 veckor. \nOxynorm 5mg 1vb, max 4 per dag.\nParacetamol 500mg 2x3 i 4 veckor.\n")
            pharma = "Enligt medicinlistan"
            #Element('type-input').element.value = "primär total höftledsplastik utan cement"
            Element('type-input').element.value = "höftprotes utan cement"
            Element('ward-input').element.value = "78"
            Element('pharma-list').element.innerText = pharma_pat
            Element('plan').element.innerText = ("Sårkontroll om 14 dagar.\nTelefonkontakt med operatören om 4 månader.\n\nVid frågor, sårläckage, feber eller andra symptom hör av dig till avdelning 78.")
            Element('epikris').element.innerText = ("Ansvarig läkare:\nInskrivningsdatum:\n%s\n\nUtskrivningsdatum:\n%s\n\nVårdsammanfattning:\nHöftledsplastik %s och mobilisering utförd.\n\nUppmärksamhetssignal:\nKontrollerad\n\nBedömning:\nPatienten skrivs ut med pharmakologisk behandling. Bedöms kunna återgå till habitualtillstånd inom 4 månader. \n\nPlanering:\nSårkontroll om 14 dagar. Telefonkontakt med operatör om 4 månader.\n\nLäkemedel\n%s\n\nICD\nM161\n%s\n\n" %(indate, outdate, side, pharma, ICD))
        if ICD == "NFB39" :
            pharma_pat = ("Medicin från avdelningen:\nEtoricoxib 120mg 1 tablett 1 gånger dagligen i 5 dagar. Mot smärta.\n\nMedicin från apoteket:\nOmeprazol 20mg 1 tablett 1 gång dagligen i 2 veckor. Magskyddande.\nCilaxoral 7,5mg/ml 10 droppar i 1 vecka. Förebygger förstoppning.\nEliquis 2,5mg 1 tablett 2 gånger dagligen i 30 dagar. Förebygger blodpropp.\nOxynorm 5mg 1 vid behov, max 4 dagligen, i 2 veckor. Korttidsverkande mot smärta.\nParacetamol 500mg 2 tabletter 3 gånger dagligen i 4 veckor. Smärtlindrande\nSolvezink 45mg 1 tablett 2 gånger dagligen i 3 veckor. För sårläkning.")
            #pharma = ("Cilaxoral 7,5mg/ml 10 droppar i 1 vecka.\nEliquis 2,5mg 1x2 i 30 dagar.\nOmeprazol 20mg 1x1 i 2 veckor. \nOxynorm 5mg 1vb, max 4 per dag.\nParacetamol 500mg 2x3 i 4 veckor.\n")
            pharma = "Enligt medicinlistan"
            #Element('type-input').element.value = "primär total höftledsplastik med hybridteknik"
            Element('type-input').element.value = "höftprotes med hybridteknik"
            Element('ward-input').element.value = "78"
            Element('pharma-list').element.innerText = pharma_pat
            Element('plan').element.innerText = ("Sårkontroll om 14 dagar.\nTelefonkontakt med operatören om 4 månader.\n\nVid frågor, sårläckage, feber eller andra symptom hör av dig till avdelning 78.")
            Element('epikris').element.innerText = ("Ansvarig läkare:\nInskrivningsdatum:\n%s\n\nUtskrivningsdatum:\n%s\n\nVårdsammanfattning:\nHöftledsplastik %s och mobilisering utförd.\n\nUppmärksamhetssignal:\nKontrollerad\n\nBedömning:\nPatienten skrivs ut med pharmakologisk behandling. Bedöms kunna återgå till habitualtillstånd inom 4 månader. \n\nPlanering:\nSårkontroll om 14 dagar. Telefonkontakt med operatör om 4 månader.\n\nLäkemedel\n%s\n\nICD\nM161\n%s\n\n" %(indate, outdate, side, pharma, ICD))

        if ICD == "NFB49" :
            pharma_pat = ("Medicin från avdelningen:\nEtoricoxib 120mg 1 tablett 1 gånger dagligen i 5 dagar. Mot smärta.\n\nMedicin från apoteket:\nOmeprazol 20mg 1 tablett 1 gång dagligen i 2 veckor. Magskyddande.\nCilaxoral 7,5mg/ml 10 droppar i 1 vecka. Förebygger förstoppning.\nEliquis 2,5mg 1 tablett 2 gånger dagligen i 30 dagar. Förebygger blodpropp.\nOxynorm 5mg 1 vid behov, max 4 dagligen, i 2 veckor. Korttidsverkande mot smärta.\nParacetamol 500mg 2 tabletter 3 gånger dagligen i 4 veckor. Smärtlindrande\nSolvezink 45mg 1 tablett 2 gånger dagligen i 3 veckor. För sårläkning.")
            pharma = "Enligt medicinlistan"
            Element('type-input').element.value = "höftprotes med cement"
            #Element('type-input').element.value = "primär total höftledsplastik med cement"
            Element('ward-input').element.value = "78"
            Element('pharma-list').element.innerText = pharma_pat 
            Element('plan').element.innerText = ("Sårkontroll om 2-3 veckor.\nTelefonkontakt med operatören om 3 månader.\nRemiss till sjukgymnast skickas.\n\nVid frågor, sårläckage, feber eller andra symptom hör av dig till avdelning 78.")

            Element('epikris').element.innerText = ("Ansvarig läkare:\nInskrivningsdatum:\n%s\n\nUtskrivningsdatum:\n%s\n\nVårdsammanfattning:\nHöftledsplastik %s och mobilisering utförd.\n\nUppmärksamhetssignal:\nKontrollerad\n\nBedömning:\nPatienten skrivs ut med pharmakologisk behandling. Bedöms kunna återgå till habitualtillstånd inom 4 månader. \n\nPlanering:\nSårkontroll om 14 dagar. Telefonkontakt med operatör om 3 månader. Remiss till sjukgymnast skickas.\n\nLäkemedel\n%s\n\nICD\nM161\n%s\n\n" %(indate, outdate, side, pharma, ICD))
        if ICD == "NGB49" :
            pharma_pat = ("Medicin från avdelningen:\nEtoricoxib 120mg 1 tablett 1 gånger dagligen i 5 dagar. Mot smärta.\n\nMedicin från apoteket:\nOmeprazol 20mg 1 tablett 1 gång dagligen i 2 veckor. Magskyddande.\nCilaxoral 7,5mg/ml 10 droppar i 1 vecka. Förebygger förstoppning.\nEliquis 2,5mg 1 tablett 2 gånger dagligen i 10 dagar. Förebygger blodpropp.\nOxynorm 5mg 1 vid behov, max 4 dagligen, i 2 veckor. Korttidsverkande mot smärta.\nParacetamol 500mg 2 tabletter 3 gånger dagligen i 4 veckor. Smärtlindrande\nSolvezink 45mg 1 tablett 2 gånger dagligen i 3 veckor. För sårläkning.")
            if "båda sidor" == Element('side-input').element.value:
                pharma_pat = pharma_pat + "\nOxycontin 5mg 1x2 i 2 veckor. Långtidsverkande mot smärta. (bilaterala knän)"
            pharma = "Enligt medicinlistan"
            #Element('type-input').element.value = "primär totalprotes i knäled med cement"
            Element('type-input').element.value = "protes i knäled med cement"
            Element('ward-input').element.value = "78"
            Element('pharma-list').element.innerText = pharma_pat
            Element('plan').element.innerText = ("Sårkontroll om 2-3 veckor.\nTelefonkontakt med operatören om 3 månader.\nRemiss till sjukgymnast.\n\nVid frågor, sårläckage, feber eller andra symptom hör av dig till avdelning 78.")

            Element('epikris').element.innerText = ("Ansvarig läkare:\nInskrivningsdatum:\n%s\n\nUtskrivningsdatum:\n%s\n\nVårdsammanfattning:\nKnäledsplastik %s och mobilisering utförd.\n\nUppmärksamhetssignal:\nKontrollerad\n\nBedömning:\nPatienten skrivs ut med farmakologisk behandling. Bedöms kunna återgå till habitualtillstånd inom 4 månader. \n\nPlanering:\nSårkontroll om 2-3 veckor. Telefonkontakt med operatör om 3 månader.\n Remiss till sjukgymnast.\n\nLäkemedel\n%s\n\nICD\nM161\n%s\n\n" %(indate, outdate, side, pharma, ICD))
        if ICD == "ABC99" :
            pharma_pat = ("Medicin från avdelningen:\nEtoricoxib 120mg 1 tablett 1 gånger dagligen i 5 dagar. Mot smärta.\n\nMedicin från apoteket:\nOmeprazol 20mg 1 tablett 1 gång dagligen i 2 veckor. Magskyddande.\nCilaxoral 7,5mg/ml 10 droppar i 1 vecka. Förebygger förstoppning.\nEliquis 2,5mg 1 tablett 2 gånger dagligen i 10 dagar. Förebygger blodpropp.\nOxynorm 5mg 1 vid behov, max 4 dagligen, i 2 veckor. Korttidsverkande mot smärta.\nParacetamol 500mg 2 tabletter 3 gånger dagligen i 4 veckor. Smärtlindrande\nSolvezink 45mg 1 tablett 2 gånger dagligen i 3 veckor. För sårläkning.")
            if "båda sidor" == Element('side-input').element.value:
                pharma_pat = pharma_pat + "\nOxycontin 5mg 1x2 i 2 veckor. Långtidsverkande mot smärta. (bilaterala knän)"
            pharma = "Enligt medicinlistan"
            Element('type-input').element.value = "dekompression av ryggmärgen och nervrötter"
            Element('ward-input').element.value = "78"
            Element('pharma-list').element.innerText = pharma_pat
            Element('plan').element.innerText = ("Sårkontroll om 2 veckor. Sjukgymnast 2 månader. Telefonsamtal med operator 2 månader.\nRemiss till sjukgymnast.\n\nVid frågor, sårläckage, feber eller andra symtpom hör av dig till avdelning 78.")
            side = ""
            Element('epikris').element.innerText = ("Ansvarig läkare:\nInskrivningsdatum:\n%s\n\nUtskrivningsdatum:\n%s\n\nVårdsammanfattning:\nDekompression av nervrötter och ryggmärg samt mobilisering utförd.\n\nUppmärksamhetssignal:\nKontrollerad\n\nBedömning:\nPatienten skrivs ut med pharmakologisk behandling. Bedöms kunna återgå till habitualtillstånd inom 4 månader. \n\nPlanering:\nSårkontroll om 14 dagar. Remiss skickas till sjukgymnast. Telefonkontakt med operatör om 2 månader.\n\nLäkemedel\n%s\n\nICD\nMM488K\n%s\n\n" %(indate, outdate, side, pharma, ICD))
        Element('indate-input').element.value = (str(yesterday))
        Element('indate-input').element.value = (str(yesterday))
        Element('opdate-input').element.value = (str(yesterday))
    def submit_function(*args, **kwargs):
        global ICD 
        global indate 
        global outdate 
        global opdate 
        global type 
        global side 
        global ward 
        side = Element('side-input').element.value
        #print('args:', args)
        #print('kwargs:', kwargs)

        console.log(f'args: {args}')
        console.log(f'kwargs: {kwargs}')

        indate = Element('indate-input').element.value
        outdate = Element('outdate-input').element.value
        opdate = Element('opdate-input').element.value
        type = Element('type-input').element.value
        if ICD == "ABC99" :
            side=""
        else:
            side = Element('side-input').element.value
        ward = Element('ward-input').element.value
        #print('indate:', indate)
        console.log(f'indate: {indate}')
        console.log(f'outdate: {outdate}')
        console.log(f'opdate: {opdate}')
        console.log(f'type: {type}')
        console.log(f'side: {side}')
        console.log(f'ward: {ward}')
        Element('output').element.innerText = ("Du inkom %s till ortopeden Arvika sjukhus för %s %s som opererades %s. Operationen var komplikationsfri och efter operationen har du mått väsentligen bra. Du är adekvat smärtlindrad och har kunnat mobiliseras bra med sjukgymnast på avdelningen. Du anses vara utskrivningsklar från avdelning %s." % (indate, type, side, opdate, ward))

    #print("Du inkom %s till ortopeden Arvika sjukhus för %s %s sida som opererades in den %s. Operationen var komplikationsfri och efter operationen har du mått väsentligen bra. Du är adekvat smärtlindrad och har kunnat mobiliseras bra med sjukgymnast på avdelningen. Du anses tillsammans med oss vara utskrivningsklar från avdelning %s." % (indate, type, side, opdate, ward))

    </py-script>
</body>
